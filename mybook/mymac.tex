% Macros for hangul

\input luatexko.sty

% hangul font setting for plain tex
% borrowed from luatexko-doc.tex
%
\sethangulfont\tenmj="Noto Serif CJK KR Light:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default;" at 9.8pt
\sethangulfont\tentz="Noto Sans Mono CJK KR:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default;" at 9.5pt
\sethangulfont\tenbd="Noto Serif CJK KR Bold:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default;" at 9.8pt
\sethangulfont\tensn="Noto Sans CJK KR DemiLight:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  +compresspunctuations" at 9.8pt

\sethangulfont\ninemj="Noto Serif CJK KR Light:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 8.8pt
\sethangulfont\ninetz="Noto Sans Mono CJK KR:
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default;" at 8.5pt
\sethangulfont\ninebd="Noto Serif CJK KR Bold:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 8.8pt
\sethangulfont\ninesn="Noto Sans CJK KR DemiLight:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 8.8pt

\sethangulfont\eightmj="Noto Serif CJK KR Light:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 7.8pt
\sethangulfont\eighttz="Noto Sans Mono CJK KR:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 7.5pt
\sethangulfont\eightbd="Noto Serif CJK KR Bold:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 7.8pt
\sethangulfont\eightsn="Noto Sans CJK KR DemiLight:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 7.8pt

\sethangulfont\sevenmj="Noto Serif CJK KR Light:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 6.8pt

\sethangulfont\twelvemj="Noto Serif CJK KR Bold:%
  language=KOR;%
  script=hang;%
  interhangul=-0.04em;%
  interlatincjk=.125em;%
  charraise=-0.06em;%
  +compresspunctuations;%
  expansion=default" at 11.8pt

% hangul in math mode
\font\texthangul="Noto Sans CJK KR DemiLight" at 9.8pt
\font\texthangulnine="Noto Sans CJK KR DemiLight" at 8.8pt
\font\texthanguleight="Noto Sans CJK KR DemiLight" at 7.8pt
\font\scripthangul="Noto Sans CJK KR Regular" at 6.8pt
\font\scripthangulsix="Noto Sans CJK KR Regular" at 5.8pt
\font\scriptscripthangul="Noto Sans CJK KR Medium" at 4.8pt

% borrowed from manmac.tex
%
\catcode`@=11 % borrow the private macros of PLAIN (with care)

\font\tentex=cmtex10

\font\inchhigh=cminch
\font\titlefont="Noto Sans CJK KR Black" at 40pt
\font\sectionfont="Noto Sans CJK KR Medium" at 18pt

\font\ninerm=cmr9
\let\mc=\ninerm % medium caps
\font\eightrm=cmr8
\font\sixrm=cmr6

\font\ninei=cmmi9
\font\eighti=cmmi8
\font\sixi=cmmi6
\skewchar\ninei='177 \skewchar\eighti='177 \skewchar\sixi='177

\font\ninesy=cmsy9
\font\eightsy=cmsy8
\font\sixsy=cmsy6
\skewchar\ninesy='60 \skewchar\eightsy='60 \skewchar\sixsy='60

\font\eightss=cmssq8

\font\eightssi=cmssqi8

\font\ninebf=cmbx9
\font\eightbf=cmbx8
\font\sixbf=cmbx6

\font\ninett=cmtt9
\font\eighttt=cmtt8

\hyphenchar\tentt=-1 % inhibit hyphenation in typewriter type
\hyphenchar\ninett=-1
\hyphenchar\eighttt=-1

\font\ninesl=cmsl9
\font\eightsl=cmsl8

\font\nineit=cmti9
\font\eightit=cmti8

\font\tenu=cmu10 % unslanted text italic
\font\magnifiedfiverm=cmr5 at 10pt
\font\cmman=cmman % font used for miscellaneous Computer Modern variations

%
\newskip\ttglue
\def\tenpoint{\def\rm{\fam0\tenrm\tenmj}%
  \textfont0=\tenrm \scriptfont0=\sevenrm \scriptscriptfont0=\fiverm
  \textfont1=\teni \scriptfont1=\seveni \scriptscriptfont1=\fivei
  \textfont2=\tensy \scriptfont2=\sevensy \scriptscriptfont2=\fivesy
  \textfont3=\tenex \scriptfont3=\tenex \scriptscriptfont3=\tenex
  \setmathhangulfonts\texthangul\scripthangul\scriptscripthangul
  \def\it{\fam\itfam\tenit\tensn}%
  \textfont\itfam=\tenit
  \def\sl{\fam\slfam\tensl\tensn}%
  \textfont\slfam=\tensl
  \def\bf{\fam\bffam\tenbf\tenbd}%
  \textfont\bffam=\tenbf \scriptfont\bffam=\sevenbf
  \scriptscriptfont\bffam=\fivebf
  \def\tt{\fam\ttfam\tentt\tentz}%
  \textfont\ttfam=\tentt
  \tt \ttglue=.5em plus.25em minus.15em
  \normalbaselineskip=15pt
  \let\sc=\eightrm
  \let\big=\tenbig
  \setbox\strutbox=\hbox{\vrule height8.5pt depth3.5pt width\z@}%
  \normalbaselines\rm}

\def\ninepoint{\def\rm{\fam0\ninerm\ninemj}%
  \textfont0=\ninerm \scriptfont0=\sixrm \scriptscriptfont0=\fiverm
  \textfont1=\ninei \scriptfont1=\sixi \scriptscriptfont1=\fivei
  \textfont2=\ninesy \scriptfont2=\sixsy \scriptscriptfont2=\fivesy
  \textfont3=\tenex \scriptfont3=\tenex \scriptscriptfont3=\tenex
  \setmathhangulfonts\texthangulnine\scripthangulsix\scriptscripthangul
  \def\it{\fam\itfam\nineit\ninesn}%
  \textfont\itfam=\nineit
  \def\sl{\fam\slfam\ninesl\ninesn}%
  \textfont\slfam=\ninesl
  \def\bf{\fam\bffam\ninebf\ninebd}%
  \textfont\bffam=\ninebf \scriptfont\bffam=\sixbf
   \scriptscriptfont\bffam=\fivebf
  \def\tt{\fam\ttfam\ninett\ninetz}%
  \textfont\ttfam=\ninett
  \tt \ttglue=.5em plus.25em minus.15em
  \normalbaselineskip=13pt
  \let\sc=\sevenrm
  \let\big=\ninebig
  \setbox\strutbox=\hbox{\vrule height8pt depth3pt width\z@}%
  \normalbaselines\rm}

\def\eightpoint{\def\rm{\fam0\eightrm\eightmj}%
  \textfont0=\eightrm \scriptfont0=\sixrm \scriptscriptfont0=\fiverm
  \textfont1=\eighti \scriptfont1=\sixi \scriptscriptfont1=\fivei
  \textfont2=\eightsy \scriptfont2=\sixsy \scriptscriptfont2=\fivesy
  \textfont3=\tenex \scriptfont3=\tenex \scriptscriptfont3=\tenex
  \setmathhangulfonts\texthanguleight\scripthangulsix\scriptscripthangul
  \def\it{\fam\itfam\eightit\eightsn}%
  \textfont\itfam=\eightit
  \def\sl{\fam\slfam\eightsl\eightsn}%
  \textfont\slfam=\eightsl
  \def\bf{\fam\bffam\eightbf\eightbd}%
  \textfont\bffam=\eightbf \scriptfont\bffam=\sixbf
   \scriptscriptfont\bffam=\fivebf
  \def\tt{\fam\ttfam\eighttt\eighttz}%
  \textfont\ttfam=\eighttt
  \tt \ttglue=.5em plus.25em minus.15em
  \normalbaselineskip=11pt
  \let\sc=\sixrm
  \let\big=\eightbig
  \setbox\strutbox=\hbox{\vrule height7pt depth2pt width\z@}%
  \normalbaselines\rm}

\def\tenmath{\tenpoint\fam-1 } % use after $ in ninepoint sections
\def\tenbig#1{{\hbox{$\left#1\vbox to8.5pt{}\right.\n@space$}}}
\def\ninebig#1{{\hbox{$\textfont0=\tenrm\textfont2=\tensy
  \left#1\vbox to7.25pt{}\right.\n@space$}}}
\def\eightbig#1{{\hbox{$\textfont0=\ninerm\textfont2=\ninesy
  \left#1\vbox to6.5pt{}\right.\n@space$}}}

\def\.#1{\leavevmode\hbox{\tentex % typewriter type for strings
  \let\\=\BS % backslash in a string
  \let\{=\LB % left brace in a string
  \let\}=\RB % right brace in a string
  \let\~=\TL % tilde in a string
  \let\ =\SP % space in a string
  \let\_=\UL % underline in a string
  \let\&=\AM % ampersand in a string
  \let\^=\CF % circumflex in a string
  #1\kern.05em}}
\chardef\AM=`\& % ampersand character in a string
\chardef\BS=`\\ % backslash in a string
\chardef\LB=`\{ % left brace in a string
\chardef\RB=`\} % right brace in a string
\def\SP{{\tt\char`\ }} % (visible) space in a string
\chardef\TL=`\~ % tilde in a string
\chardef\UL=`\_ % underline character in a string
\chardef\CF=`\^ % circumflex character in a string

\def\CEE/{{\mc C\spacefactor1000}}
\def\UNIX/{{\mc U\kern-.05emNIX\spacefactor1000}}
\def\TEX/{\TeX}
\def\CPLUSPLUS/{{\mc C\PP\spacefactor1000}}
\def\Cee{\CEE/} % for backward compatibility
\def\Cpp{\CPLUSPLUS/} % for backward compatibility

\newbox\PPbox % symbol for ++
\setbox\PPbox=\hbox{\kern.5pt\raise1pt\hbox{\sevenrm+\kern-1pt+}\kern.5pt}
\def\PP{\copy\PPbox}
\newbox\MMbox \setbox\MMbox=\hbox{\kern.5pt\raise1pt\hbox{\sevensy\char0
 \kern-1pt\char0}\kern.5pt}
\def\MM{\copy\MMbox}

% framing
\def\frame #1#2#3#4{\vbox{\hrule height #1pt%     TOP RULE
  \hbox{\vrule width #1pt\kern #2pt%              RULE AND SPACE ON LEFT
  \vbox{\kern #2pt%                               SPACE AT TOP
  \vbox{\hsize #3\noindent #4}%                   MATERIAL THAT WILL BE BOXED
  \kern #2pt}%                                    SPACE AT BOTTOM
  \kern #2pt\vrule width #1pt}%                   SPACE AND RULE ON RIGHT
  \hrule height0pt depth #1pt}}%,                 BOTTOM RULE
\def\fitframe #1#2#3{\vbox{\hrule height#1pt%     TOP RULE
  \hbox{\vrule width#1pt\kern #2pt%               RULE AND SPACE ON LEFT
  \vbox{\kern #2pt\hbox{#3}\kern #2pt}%           TOP, MATERIAL, BOTTOM
  \kern #2pt\vrule width#1pt}%                    SPACE AND RULE ON RIGHT
  \hrule height0pt depth#1pt}}%                   BOTTOM RULE

{\obeyspaces\gdef {\ }}
% macros for verbatim scanning
\chardef\other=12
\def\ttverbatim{\begingroup
  \catcode`\\=\other
  \catcode`\{=\other
  \catcode`\}=\other
  \catcode`\$=\other
  \catcode`\&=\other
  \catcode`\#=\other
  \catcode`\%=\other
  \catcode`\~=\other
  \catcode`\_=\other
  \catcode`\^=\other
  \obeyspaces \obeylines \tt}

\outer\def\begintt{$$\let\par=\endgraf \ttverbatim \parskip=\z@
  \catcode`\|=0 \rightskip-5pc \ttfinish}
{\catcode`\|=0 |catcode`|\=\other % | is temporary escape character
  |obeylines % end of line is active
  |gdef|ttfinish#1^^M#2\endtt{#1|vbox{#2}|endgroup$$}}

% ignore
\def\ignore {\count255=0 \begingroup
      \loop \catcode\count255=14  % Make everything a comment character.
         \advance\count255 by1 \ifnum\count255<127
      \repeat \catcode`\!=0 }     % Makes ! an escape character.
{\catcode`\!=0 !gdef!E{!endgroup}}% Defines the `stop ignoring' command.

% non-centered displays
\outer\def\begindisplay{\obeylines\startdisplay}
{\obeylines\gdef\startdisplay#1
  {\catcode`\^^M=5$$#1\halign\bgroup\indent##\hfil&&\qquad##\hfil\cr}}
\outer\def\enddisplay{\crcr\egroup$$}

% Token for \aftergroup to reset color
\def\colorstackpop{\pdfextension colorstack 0 pop}
\def\setcmykcolor#1{%
  \pdfextension colorstack 0 push {#1 k #1 K}%
  \aftergroup\colorstackpop
}
\def\setrgbcolor#1{%
  \pdfextension colorstack 0 push {#1 rg #1 RG}%
  \aftergroup\colorstackpop
}
\def\black{\setcmykcolor{0 0 0 1}}
\def\blue{\setcmykcolor{1 1 0 0}}
\def\red{\setrgbcolor{0.8 0 0}}
\def\yellow{\setrgbcolor{0.5 0.5 0}}

% include graphics
% usage: \includegraphics width 3cm height 5cm {donknuth.png}
\def\includegraphics#1#{%
  \def\next{%
    \unless\ifcsname PicKey #1 \the\toks0\endcsname
      \immediate\saveimageresource #1 {\the\toks0}%
      \expandafter\xdef\csname PicKey #1 \the\toks0\endcsname{\the\lastsavedimageresourceindex}%
    \fi
    \expandafter\useimageresource\csname PicKey #1 \the\toks0\endcsname\relax}%
  \afterassignment\next\toks0= }

\catcode`\@=12
\tenpoint

